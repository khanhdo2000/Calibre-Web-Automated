---
services:
  calibre-web-automated:
    image: crocodilestick/calibre-web-automated:latest
    container_name: calibre-web-automated
    environment:
      # Only change these if you know what you're doing
      - PUID=1000
      - PGID=1000
      # Edit to match your current timezone https://en.wikipedia.org/wiki/List_of_tz_database_time_zones
      - TZ=UTC
      # Sets the listening port for the application. Defaults to 8083.
      # - CWA_PORT_OVERRIDE=8083
      # Hardcover API Key required for Hardcover as a Metadata Provider, get one here: https://docs.hardcover.app/api/getting-started/
      - HARDCOVER_TOKEN=your_hardcover_api_key_here
      # If your library is on a network share (e.g., NFS/SMB), disables WAL and chown to reduce locking/permission issues,
      # and switches file watching to polling (more reliable on network mounts) instead of inotify.
      # Accepts: true/false (default: false)
      - NETWORK_SHARE_MODE=false
      # If you want to force polling mode regardless of share type, set CWA_WATCH_MODE=poll
      # - CWA_WATCH_MODE=poll
      # Skip the automatic library detection/mount at startup. When enabled, the auto-library service will not run.
      # Accepts: true/yes/1 to disable auto-mount (default: false)
      # - DISABLE_LIBRARY_AUTOMOUNT=false
      
      # S3 Cover Storage Configuration
      # Set these environment variables or uncomment and configure below
      # - S3_ENABLED=true
      # - S3_BUCKET=your-s3-bucket-name
      # - S3_REGION=us-east-1
      # - S3_ACCESS_KEY=your-access-key-here
      # - S3_SECRET_KEY=your-secret-key-here
      # - S3_CDN_URL=
    volumes:
      # CW users migrating should stop their existing CW instance, make a copy of the config folder, and bind that here to carry over all of their user settings ect.
      - ./config:/config 
      # This is an ingest dir, NOT a library one. Anything added here will be automatically added to your library according to the settings you have configured in CWA Settings page. All files placed here are REMOVED AFTER PROCESSING
      - ./ingest:/cwa-book-ingest
      # If you don't have an existing library, CWA will automatically create one at the bind provided here
      - ~/calibre-web:/calibre-library
      # If you use calibre plugins, you can bind your plugins folder here to have CWA attempt to add them to it's workflow (WIP)
      - ./plugins:/config/.config/calibre/plugins

      # DEV SPECIFIC BINDS - Live code editing
      ### Mount your local code into the container for real-time development
      ### Changes to these files will be reflected immediately without restart
      - ./cps:/app/calibre-web-automated/cps
      - ./scripts:/app/calibre-web-automated/scripts
      - ./upload_covers_standalone.py:/app/calibre-web-automated/upload_covers_standalone.py
      - ./upload_covers_standalone_README.md:/app/calibre-web-automated/upload_covers_standalone_README.md

    ports:
      # Change the first number to change the port you want to access the Web UI, not the second
      - 8083:8083
    # If you set CWA_PORT_OVERRIDE to a port below 1024, you may need to uncomment the following line:
    # cap_add:
    #   - NET_BIND_SERVICE
    restart: unless-stopped